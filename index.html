<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>üè° Realtor House Finder - Weekly Excel Listings</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        /* Dark Modern Theme */
        :root {
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #16213e;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #6b7280;
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --accent-tertiary: #06b6d4;
            --border-color: #374151;
            --shadow-color: rgba(0, 0, 0, 0.3);
        }

        /* Dark gradient backgrounds */
        .gradient-bg {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            position: relative;
            overflow: hidden;
        }
        
        .gradient-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            pointer-events: none;
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 25%, #16213e 50%, #0f172a 75%, #1e293b 100%);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Enhanced card hover effects - Dark Theme */
        .card-hover {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
        }
        
        .card-hover::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .card-hover:hover::before {
            left: 100%;
        }
        
        .card-hover:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px -12px var(--shadow-color), 0 0 0 1px var(--accent-primary);
            border-color: var(--accent-primary);
        }
        
        /* Property card enhancements - Dark Theme */
        .property-card {
            background: linear-gradient(145deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            color: var(--text-primary);
        }
        
        .property-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary), var(--accent-tertiary));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .property-card:hover::before {
            transform: scaleX(1);
        }
        
        .property-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px var(--shadow-color);
            border-color: var(--accent-primary);
        }
        
        /* Enhanced loading animation */
        .loading {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .pulse-loading {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Advanced fade animations */
        .fade-in {
            animation: fadeInUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .fade-in-delay-1 {
            animation: fadeInUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.1s both;
        }
        
        .fade-in-delay-2 {
            animation: fadeInUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.2s both;
        }
        
        .fade-in-delay-3 {
            animation: fadeInUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.3s both;
        }
        
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        /* Button enhancements - Dark Theme with Touch Optimization */
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            min-height: 48px; /* Touch target minimum */
            min-width: 48px;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            border: 1px solid var(--accent-primary);
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
        }
        
        .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--accent-tertiary) 0%, #10b981 100%);
            transition: all 0.3s ease;
            min-height: 48px;
            min-width: 48px;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            border: 1px solid var(--accent-tertiary);
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(6, 182, 212, 0.4);
        }
        
        .btn-success:active {
            transform: translateY(0);
            box-shadow: 0 5px 15px rgba(6, 182, 212, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            transition: all 0.3s ease;
            min-height: 48px;
            min-width: 48px;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            border: 1px solid #ef4444;
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4);
        }
        
        .btn-danger:active {
            transform: translateY(0);
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.3);
        }
        
        /* Glass morphism effect - Dark Theme */
        .glass {
            background: rgba(99, 102, 241, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }
        
        /* Floating animation */
        .float {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        /* Shimmer effect - Dark Theme */
        .shimmer {
            background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--border-color) 50%, var(--bg-tertiary) 75%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        /* Price highlight - Dark Theme */
        .price-highlight {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }
        
        /* Status badges - Dark Theme */
        .status-badge {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-tertiary));
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            min-height: 32px; /* Touch target */
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Enhanced touch targets for mobile */
        .touch-target {
            min-height: 44px;
            min-width: 44px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Input field enhancements for dark theme */
        .input-dark {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            transition: all 0.3s ease;
            z-index: 10;
            position: relative;
        }
        
        .input-dark:focus {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            background: var(--bg-secondary);
            z-index: 20;
        }
        
        .input-dark::placeholder {
            color: var(--text-muted);
        }
        
        /* Dropdown styling fixes */
        select.input-dark {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            z-index: 10;
            position: relative;
        }
        
        select.input-dark:focus {
            background: var(--bg-secondary);
            z-index: 20;
        }
        
        select.input-dark option {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 8px 12px;
        }
        
        /* Location suggestions dropdown */
        #locationSuggestions {
            background: var(--bg-secondary) !important;
            border: 1px solid var(--border-color) !important;
            z-index: 50 !important;
            position: absolute !important;
            top: 100% !important;
            left: 0 !important;
            right: 0 !important;
            max-height: 200px !important;
            overflow-y: auto !important;
            border-radius: 12px !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3) !important;
        }
        
        #locationSuggestions .suggestion-item {
            padding: 12px 16px;
            color: var(--text-primary);
            cursor: pointer;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s ease;
        }
        
        #locationSuggestions .suggestion-item:hover {
            background: var(--bg-tertiary);
        }
        
        #locationSuggestions .suggestion-item:last-child {
            border-bottom: none;
        }
        
        /* Mobile optimizations - Dark Theme with Enhanced Touch */
        @media (max-width: 768px) {
            .mobile-padding {
                padding: 1rem;
            }
            .mobile-text {
                font-size: 0.875rem;
            }
            .mobile-button {
                padding: 16px 20px; /* Larger touch targets */
                font-size: 0.875rem;
                min-height: 48px;
                min-width: 48px;
            }
            .mobile-grid {
                grid-template-columns: 1fr;
                gap: 1rem; /* More spacing for touch */
            }
            .mobile-card {
                margin-bottom: 1rem;
                padding: 1rem;
            }
            
            /* Enhanced touch targets for mobile */
            .btn-primary, .btn-success, .btn-danger {
                min-height: 52px; /* Larger on mobile */
                padding: 16px 24px;
                font-size: 16px; /* Prevent zoom on iOS */
            }
            
            /* Larger input fields for mobile */
            input, select {
                min-height: 48px;
                font-size: 16px; /* Prevent zoom on iOS */
                padding: 12px 16px;
            }
            
            /* Better spacing for property cards on mobile */
            .property-card {
                margin-bottom: 1.5rem;
                padding: 1.25rem;
            }
        }
        
        /* Custom scrollbar - Dark Theme */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--accent-secondary), var(--accent-tertiary));
        }
        
        /* Dark theme body */
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
        }
    </style>
</head>
<body class="min-h-screen" style="background: var(--bg-primary); color: var(--text-primary);">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-2xl relative">
        <div class="container mx-auto px-4 py-6 md:py-8">
            <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0">
                <div class="flex items-center space-x-3 md:space-x-4 fade-in">
                    <div class="relative">
                        <i class="fas fa-home text-3xl md:text-4xl float"></i>
                        <div class="absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full animate-pulse"></div>
                    </div>
                    <div>
                        <h1 class="text-2xl md:text-4xl font-bold bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent">
                            Realtor House Finder
                        </h1>
                        <p class="text-sm md:text-base text-blue-100 mt-1">Professional Real Estate Search</p>
                    </div>
                </div>
                <div class="glass rounded-lg px-4 py-2 fade-in-delay-1">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-calendar-alt text-yellow-300"></i>
                        <span class="text-sm font-medium">Weekly Excel Reports</span>
                    </div>
                    <div class="flex items-center space-x-2 mt-1">
                        <i class="fas fa-bolt text-green-300"></i>
                        <span class="text-xs text-blue-100">Powered by RapidAPI</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Search Form -->
        <div class="rounded-2xl shadow-2xl p-6 md:p-8 mb-8 md:mb-12 card-hover fade-in" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
            <div class="text-center mb-8">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 flex items-center justify-center" style="color: var(--text-primary);">
                    <i class="fas fa-search mr-3" style="color: var(--accent-primary);"></i>
                    <span class="bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                Search Properties
                    </span>
            </h2>
                <p class="text-lg" style="color: var(--text-secondary);">Find your perfect property with our advanced search</p>
            </div>
            
            <form id="searchForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="fade-in-delay-1 relative">
                    <label for="location" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-map-marker-alt mr-2" style="color: var(--accent-primary);"></i>
                        Location
                    </label>
                    <div class="relative">
                        <input type="text" id="location" placeholder="e.g., Nashville, TN or 37206" 
                               class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target" 
                               autocomplete="off" required>
                        <div id="locationSuggestions" class="absolute z-50 w-full mt-1 bg-white rounded-xl shadow-2xl border max-h-60 overflow-y-auto hidden" style="background: var(--bg-secondary); border-color: var(--border-color);">
                            <!-- Suggestions will be populated here -->
                        </div>
                    </div>
                </div>
                
                <div class="fade-in-delay-2">
                    <label for="propertyType" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-building mr-2" style="color: var(--accent-tertiary);"></i>
                        Property Type
                    </label>
                    <select id="propertyType" class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target">
                        <option value="house">üè† House</option>
                        <option value="condo">üè¢ Condo</option>
                        <option value="townhouse">üèòÔ∏è Townhouse</option>
                        <option value="apartment">üè¨ Apartment</option>
                    </select>
                </div>
                
                <div class="fade-in-delay-3">
                    <label for="limit" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-list mr-2" style="color: var(--accent-secondary);"></i>
                        Max Results
                    </label>
                    <select id="limit" class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target">
                        <option value="25">25 Properties</option>
                        <option value="50">50 Properties</option>
                        <option value="100" selected>100 Properties</option>
                        <option value="200">200 Properties</option>
                        <option value="500">500 Properties</option>
                    </select>
                </div>

                <div class="fade-in-delay-4">
                    <label for="dateRange" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-calendar-alt mr-2" style="color: var(--accent-tertiary);"></i>
                        Date Range
                    </label>
                    <select id="dateRange" class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target">
                        <option value="any">Any Time</option>
                        <option value="7">Last 7 Days</option>
                        <option value="14" selected>Last 14 Days</option>
                        <option value="30">Last 30 Days</option>
                        <option value="90">Last 90 Days</option>
                    </select>
                </div>

                <div class="fade-in-delay-5">
                    <label for="priceChange" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-tag mr-2" style="color: var(--accent-primary);"></i>
                        Price Changes
                    </label>
                    <select id="priceChange" class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target">
                        <option value="any">Any Price Change</option>
                        <option value="reduced">Price Reduced</option>
                        <option value="increased">Price Increased</option>
                        <option value="new">New Listings</option>
                    </select>
                </div>

                <div class="fade-in-delay-6">
                    <label for="daysOnMarket" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-clock mr-2" style="color: var(--accent-primary);"></i>
                        Days on Market
                    </label>
                    <select id="daysOnMarket" class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target">
                        <option value="any">Any Time</option>
                        <option value="7">Under 7 Days</option>
                        <option value="30">Under 30 Days</option>
                        <option value="90">Under 90 Days</option>
                        <option value="180">Under 180 Days</option>
                    </select>
                </div>
                
                <div class="fade-in-delay-1">
                    <label for="minPrice" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-dollar-sign mr-2" style="color: var(--accent-tertiary);"></i>
                        Min Price
                    </label>
                    <input type="number" id="minPrice" placeholder="0" 
                           class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target">
                </div>
                
                <div class="fade-in-delay-2">
                    <label for="maxPrice" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-dollar-sign mr-2" style="color: #ef4444;"></i>
                        Max Price
                    </label>
                    <input type="number" id="maxPrice" placeholder="1000000" 
                           class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target">
                </div>
                
                <div class="fade-in-delay-3">
                    <label for="bedrooms" class="block text-sm font-semibold mb-3 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-bed mr-2" style="color: var(--accent-primary);"></i>
                        Bedrooms
                    </label>
                    <select id="bedrooms" class="w-full px-4 py-3 input-dark rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 transition-all duration-300 text-lg touch-target">
                        <option value="0">Any Bedrooms</option>
                        <option value="1">1+ Bedrooms</option>
                        <option value="2">2+ Bedrooms</option>
                        <option value="3">3+ Bedrooms</option>
                        <option value="4">4+ Bedrooms</option>
                        <option value="5">5+ Bedrooms</option>
                    </select>
                </div>
                
                <div class="md:col-span-2 lg:col-span-3 flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6 mt-6">
                    <button type="submit" id="searchBtn" 
                            class="btn-primary text-white font-bold py-4 px-8 rounded-xl transition-all duration-300 flex items-center justify-center w-full sm:w-auto text-lg shadow-lg">
                        <i class="fas fa-search mr-3"></i>
                        Search Properties
                    </button>
                    <button type="button" id="testBtn" 
                            class="btn-success text-white font-bold py-4 px-8 rounded-xl transition-all duration-300 flex items-center justify-center w-full sm:w-auto text-lg shadow-lg">
                        <i class="fas fa-bug mr-3"></i>
                        Test Search
                    </button>
                </div>
            </form>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden fade-in">
            <div class="rounded-2xl shadow-2xl p-6 md:p-8 mb-8 card-hover" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 space-y-4 sm:space-y-0">
                    <div>
                        <h3 class="text-2xl md:text-3xl font-bold mb-2 flex items-center" style="color: var(--text-primary);">
                            <i class="fas fa-home mr-3" style="color: var(--accent-primary);"></i>
                            <span class="bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                                Search Results
                            </span>
                        </h3>
                        <div id="resultsCount" class="text-lg" style="color: var(--text-secondary);"></div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 w-full">
                        <button id="exportBtn" 
                                class="bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 flex flex-col items-center justify-center shadow-lg hover:shadow-xl hover:from-green-600 hover:to-emerald-600">
                            <i class="fas fa-file-excel text-2xl mb-2"></i>
                            <span class="text-sm font-semibold">Export to Excel</span>
                            <span class="text-xs opacity-90 mt-1">Download property data</span>
                        </button>
                        <button id="propertyListingsBtn" 
                                class="btn-success text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 flex flex-col items-center justify-center shadow-lg hover:shadow-xl">
                            <i class="fas fa-robot text-2xl mb-2"></i>
                            <span class="text-sm font-semibold">AI Property Analysis</span>
                            <span class="text-xs opacity-90 mt-1">Intelligent market insights</span>
                        </button>
                        <button id="marketIntelligenceBtn" 
                                class="bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 flex flex-col items-center justify-center shadow-lg hover:shadow-xl hover:from-purple-600 hover:to-pink-600">
                            <i class="fas fa-brain text-2xl mb-2"></i>
                            <span class="text-sm font-semibold">AI Market Intelligence</span>
                            <span class="text-xs opacity-90 mt-1">Smart market predictions</span>
                        </button>
                        <button id="investmentAnalysisBtn" 
                                class="bg-gradient-to-r from-indigo-500 to-purple-500 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 flex flex-col items-center justify-center shadow-lg hover:shadow-xl hover:from-indigo-600 hover:to-purple-600">
                            <i class="fas fa-chart-pie text-2xl mb-2"></i>
                            <span class="text-sm font-semibold">AI Investment Analysis</span>
                            <span class="text-xs opacity-90 mt-1">Smart investment recommendations</span>
                        </button>
                        <button id="clearBtn" 
                                class="btn-danger text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 flex flex-col items-center justify-center shadow-lg hover:shadow-xl">
                            <i class="fas fa-trash text-2xl mb-2"></i>
                            <span class="text-sm font-semibold">Clear Results</span>
                            <span class="text-xs opacity-90 mt-1">Reset search</span>
                        </button>
                    </div>
                </div>
                
                <div id="propertiesList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                
                <!-- Pagination Controls -->
                <div id="paginationControls" class="hidden mt-8 flex justify-center items-center space-x-4">
                    <button id="prevPage" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="fas fa-chevron-left mr-2"></i>Previous
                    </button>
                    <span id="pageInfo" class="px-4 py-2 bg-gray-700 text-white rounded-lg">
                        Page <span id="currentPage">1</span> of <span id="totalPages">1</span>
                    </span>
                    <button id="nextPage" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
                        Next<i class="fas fa-chevron-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Market Analytics Section -->
        <div id="analyticsSection" class="hidden fade-in">
            <div class="rounded-2xl shadow-2xl p-6 md:p-8 mb-8 card-hover" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                <div class="text-center mb-8">
                    <h3 class="text-2xl md:text-3xl font-bold mb-2 flex items-center justify-center" style="color: var(--text-primary);">
                        <i class="fas fa-chart-line mr-3" style="color: var(--accent-primary);"></i>
                        Market Analytics
                    </h3>
                    <p class="text-lg" style="color: var(--text-secondary);">Insights and trends for your search area</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Total Listings -->
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm font-medium">Total Listings</p>
                                <p id="totalListings" class="text-3xl font-bold">0</p>
                            </div>
                            <i class="fas fa-home text-4xl text-blue-200"></i>
                        </div>
                    </div>
                    
                    <!-- Average Price -->
                    <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm font-medium">Average Price</p>
                                <p id="averagePrice" class="text-3xl font-bold">$0</p>
                            </div>
                            <i class="fas fa-dollar-sign text-4xl text-green-200"></i>
                        </div>
                    </div>
                    
                    <!-- Price Range -->
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm font-medium">Price Range</p>
                                <p id="priceRange" class="text-lg font-bold">$0 - $0</p>
                            </div>
                            <i class="fas fa-chart-bar text-4xl text-purple-200"></i>
                        </div>
                    </div>
                    
                    <!-- Days on Market -->
                    <div class="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-orange-100 text-sm font-medium">Avg. Days on Market</p>
                                <p id="avgDaysOnMarket" class="text-3xl font-bold">0</p>
                            </div>
                            <i class="fas fa-clock text-4xl text-orange-200"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Property Type Distribution -->
                <div class="mb-8">
                    <h4 class="text-xl font-bold mb-4 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-pie-chart mr-2" style="color: var(--accent-primary);"></i>
                        Property Type Distribution
                    </h4>
                    <div id="propertyTypeChart" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <!-- Chart items will be populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Price Distribution -->
                <div class="mb-8">
                    <h4 class="text-xl font-bold mb-4 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-chart-area mr-2" style="color: var(--accent-primary);"></i>
                        Price Distribution
                    </h4>
                    <div id="priceDistributionChart" class="space-y-3">
                        <!-- Price range bars will be populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Recent Listings -->
                <div>
                    <h4 class="text-xl font-bold mb-4 flex items-center" style="color: var(--text-primary);">
                        <i class="fas fa-calendar-alt mr-2" style="color: var(--accent-primary);"></i>
                        Recent Listings (Last 7 Days)
                    </h4>
                    <div id="recentListings" class="text-lg" style="color: var(--text-secondary);">
                        <!-- Recent listings count will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="hidden text-center py-12">
            <div class="relative">
                <div class="loading inline-block w-16 h-16 border-4 rounded-full" style="border-color: var(--accent-primary); border-top-color: transparent;"></div>
                <div class="absolute inset-0 loading inline-block w-16 h-16 border-4 rounded-full" style="border-color: var(--accent-secondary); border-top-color: transparent; animation-delay: 0.2s; animation-duration: 1.5s;"></div>
            </div>
            <p class="mt-4 text-lg font-medium" style="color: var(--text-primary);">Searching properties...</p>
            <p class="mt-2 text-sm" style="color: var(--text-secondary);">This may take a few moments</p>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="hidden px-6 py-4 rounded-xl mb-6 shadow-lg" style="background: linear-gradient(135deg, #1f2937, #374151); border: 2px solid #ef4444;">
            <div class="flex items-center">
                <i class="fas fa-exclamation-triangle mr-3 text-xl" style="color: #ef4444;"></i>
                <span id="errorText" class="font-medium" style="color: var(--text-primary);"></span>
            </div>
        </div>

        <!-- Success Message -->
        <div id="successMessage" class="hidden px-6 py-4 rounded-xl mb-6 shadow-lg" style="background: linear-gradient(135deg, #064e3b, #065f46); border: 2px solid #10b981;">
            <div class="flex items-center">
                <i class="fas fa-check-circle mr-3 text-xl" style="color: #10b981;"></i>
                <span id="successText" class="font-medium" style="color: var(--text-primary);"></span>
            </div>
        </div>

        <!-- Report Types Section -->
        <div class="mt-12">
            <div class="text-center mb-8">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 flex items-center justify-center" style="color: var(--text-primary);">
                    <i class="fas fa-file-excel mr-3" style="color: var(--accent-primary);"></i>
                    <span class="bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                        Three Comprehensive Report Types
                    </span>
                </h2>
                <p class="text-lg" style="color: var(--text-secondary);">Choose the perfect report for your needs</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Property Listings Report -->
                <div class="rounded-2xl shadow-2xl p-8 card-hover fade-in" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="text-center">
                        <div class="relative mb-6">
                            <i class="fas fa-list text-5xl float" style="color: #10b981;"></i>
                            <div class="absolute -top-2 -right-2 w-4 h-4 rounded-full animate-pulse" style="background: #10b981;"></div>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent">Property Listings Report</h3>
                        <p class="text-lg leading-relaxed mb-4" style="color: var(--text-secondary);">Comprehensive property data with executive summary, detailed listings, property analysis, market overview, and agent contacts.</p>
                        <div class="text-left space-y-2">
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #10b981;"></i>
                                Executive Summary with market insights
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #10b981;"></i>
                                Detailed property information
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #10b981;"></i>
                                Agent contact information
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #10b981;"></i>
                                Property analysis & notes
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Market Intelligence Report -->
                <div class="rounded-2xl shadow-2xl p-8 card-hover fade-in-delay-1" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="text-center">
                        <div class="relative mb-6">
                            <i class="fas fa-chart-line text-5xl float" style="color: #8b5cf6;"></i>
                            <div class="absolute -top-2 -right-2 w-4 h-4 rounded-full animate-pulse" style="background: #8b5cf6;"></div>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">Market Intelligence Report</h3>
                        <p class="text-lg leading-relaxed mb-4" style="color: var(--text-secondary);">Advanced market analysis with trends, competitive insights, neighborhood comparisons, and strategic recommendations.</p>
                        <div class="text-left space-y-2">
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #8b5cf6;"></i>
                                Market trends & velocity analysis
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #8b5cf6;"></i>
                                Competitive analysis
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #8b5cf6;"></i>
                                Neighborhood comparisons
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #8b5cf6;"></i>
                                Strategic recommendations
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Investment Analysis Report -->
                <div class="rounded-2xl shadow-2xl p-8 card-hover fade-in-delay-2" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="text-center">
                        <div class="relative mb-6">
                            <i class="fas fa-dollar-sign text-5xl float" style="color: #6366f1;"></i>
                            <div class="absolute -top-2 -right-2 w-4 h-4 rounded-full animate-pulse" style="background: #6366f1;"></div>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 bg-gradient-to-r from-indigo-400 to-blue-400 bg-clip-text text-transparent">Investment Analysis Report</h3>
                        <p class="text-lg leading-relaxed mb-4" style="color: var(--text-secondary);">Professional investment evaluation with ROI analysis, investment scores, risk assessment, and investment recommendations.</p>
                        <div class="text-left space-y-2">
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #6366f1;"></i>
                                Investment scores & ratings
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #6366f1;"></i>
                                ROI analysis by price range
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #6366f1;"></i>
                                Risk assessment
                            </div>
                            <div class="flex items-center text-sm" style="color: var(--text-primary);">
                                <i class="fas fa-check-circle mr-2" style="color: #6366f1;"></i>
                                Investment recommendations
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-12">
            <div class="rounded-2xl shadow-2xl p-8 card-hover fade-in" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                <div class="text-center">
                    <div class="relative mb-6">
                        <i class="fas fa-download text-5xl float" style="color: var(--accent-primary);"></i>
                        <div class="absolute -top-2 -right-2 w-4 h-4 rounded-full animate-pulse" style="background: var(--accent-primary);"></div>
                    </div>
                    <h3 class="text-2xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">Excel Export</h3>
                    <p class="text-lg leading-relaxed" style="color: var(--text-secondary);">Export your search results to Excel with detailed property information, market analysis, and summary statistics.</p>
                </div>
            </div>
            
            <div class="rounded-2xl shadow-2xl p-8 card-hover fade-in-delay-1" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                <div class="text-center">
                    <div class="relative mb-6">
                        <i class="fas fa-clock text-5xl float" style="color: var(--accent-tertiary);"></i>
                        <div class="absolute -top-2 -right-2 w-4 h-4 rounded-full animate-pulse" style="background: var(--accent-tertiary);"></div>
                    </div>
                    <h3 class="text-2xl font-bold mb-4 bg-gradient-to-r from-green-400 to-blue-400 bg-clip-text text-transparent">Automated Reports</h3>
                    <p class="text-lg leading-relaxed" style="color: var(--text-secondary);">Set up weekly automated reports that generate Excel files with the latest property listings from your target areas.</p>
                </div>
            </div>
            
            <div class="rounded-2xl shadow-2xl p-8 card-hover fade-in-delay-2" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                <div class="text-center">
                    <div class="relative mb-6">
                        <i class="fas fa-chart-bar text-5xl float" style="color: var(--accent-secondary);"></i>
                        <div class="absolute -top-2 -right-2 w-4 h-4 rounded-full animate-pulse" style="background: var(--accent-secondary);"></div>
                    </div>
                    <h3 class="text-2xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">Market Analysis</h3>
                    <p class="text-lg leading-relaxed" style="color: var(--text-secondary);">Get comprehensive market analysis including price ranges, property types, and market trends in your Excel reports.</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Analytics Modal -->
    <div id="analyticsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto" style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
            <div class="p-6 border-b" style="border-color: var(--border-color);">
                <div class="flex justify-between items-center">
                    <h3 class="text-2xl font-bold" style="color: var(--text-primary);">
                        <i class="fas fa-chart-line mr-3" style="color: var(--accent-primary);"></i>
                        Usage Analytics
                    </h3>
                    <button id="closeAnalytics" class="text-gray-400 hover:text-white text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <div id="analyticsContent" class="space-y-6">
                    <!-- Analytics content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="gradient-bg text-white py-12 mt-16">
        <div class="container mx-auto px-4 text-center">
            <div class="mb-6">
                <h4 class="text-2xl font-bold mb-2">Realtor House Finder</h4>
                <p class="text-lg" style="color: var(--text-secondary);">Professional Real Estate Search & Analysis</p>
            </div>
            <div class="flex justify-center space-x-6 mb-6">
                <a href="#" class="transition-colors duration-300 hover:text-white" style="color: var(--text-secondary);">
                    <i class="fab fa-github text-2xl"></i>
                </a>
                <a href="#" class="transition-colors duration-300 hover:text-white" style="color: var(--text-secondary);">
                    <i class="fab fa-linkedin text-2xl"></i>
                </a>
                <a href="#" class="transition-colors duration-300 hover:text-white" style="color: var(--text-secondary);">
                    <i class="fab fa-twitter text-2xl"></i>
                </a>
            </div>
            <p style="color: var(--text-secondary);">&copy; 2024 Realtor House Finder. Powered by RapidAPI Real Estate Data.</p>
            <p class="text-sm mt-2" style="color: var(--text-muted);">Complete Setup Guide for Weekly Realtor Excel Listings</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
